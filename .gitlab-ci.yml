before_script:
  - export LANG=en_US.UTF-8
  - export PATH=$PATH:/usr/local/bin
  # download and load envs
  - python tools/download.py --token ${AUTO_CLOSE_TOKEN} --key-version agxzfmF1dG8tY2xvc2VyGAsSC1Byb2plY3RLZXlzGICAgJCo7pAJDA
  
  # install submodules
  - git submodule update --init --recursive

  # update gems & bundle
  - gem install bundler
  - gem outdated
  - gem update
  - bundle install
  
  - chmod 755 InRepoFrameworks/Crashlytics/iOS/Crashlytics.framework/submit
  - chmod 755 InRepoFrameworks/Crashlytics/iOS/Crashlytics.framework/run

production:
  type: build
  script: "bundle exec fastlane ios production --env production"
  tags:
    - swift2.2
  only:
    - develop
    - /^production-.*$/
alpha:
  type: build
  script: "bundle exec fastlane ios stage --env staging"
  tags:
    - swift2.2
  except:
    - /^local-.*$/ # any git refs (e.g. tag) starting with "appstore-"
    - /^translations-.*$/ # any git refs (e.g. tag) starting with "appstore-"
local:
  type: build
  script: "bundle exec fastlane ios local --env local"
  tags:
    - swift2.2
  except:
    - /^translations-.*$/ # any git refs (e.g. tag) starting with "appstore-"
translations:
  type: build
  script: "bundle exec fastlane ios localizations"
  tags:
    - swift2.2
  only:
    - develop
    - /^translations-.*$/
  